---
title: "seedbanks"
author: Emma Gloudeman, Miranda Melen
date: "2023-05-19"
output: html_document
---

#Meta Data
This is year 1 and 2 data from the greenhouse raised bed seedbank experiment.

#Packages
```{r}
library(ggplot2)
```

#Load Data
```{r}
gh_bank_all<-read.csv("/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/data/seedbanks/greenhouse_seedbank_data.csv",stringsAsFactors=T)
```

#Filter = 200 seeds
Not every pot received 200 seeds, so here we will filter to only include those that did, to simplify for now.
```{r}
gh_bank<-gh_bank_all[gh_bank_all$SeedCount==200,] #filters a data frame gh_bank_all and creates a new data frame gh_bank that contains only the rows where the value in the SeedCount column is equal to 200.
view(gh_bank)
```
##Make a compact dataframe
Here we will calculate the mean germination for each month within the gh_bank data frame and assign them to the prop_means vector
```{r}
prop_means=c(mean(gh_bank$Sep1_prop), mean(gh_bank$Oct1_prop), mean(gh_bank$Nov1_prop), 
    mean(gh_bank$Dec1_prop),mean(gh_bank$Jan1_prop),mean(gh_bank$Feb1_prop),
    mean(gh_bank$Mar1_prop),mean(gh_bank$Apr1_prop),mean(gh_bank$May1_prop),
    mean(gh_bank$Jun1_prop),mean(gh_bank$Jul1_prop),mean(gh_bank$Aug1_prop),
    mean(gh_bank$Sep2_prop),mean(gh_bank$Oct2_prop),mean(gh_bank$Nov2_prop), 
    mean(gh_bank$Dec2_prop),mean(gh_bank$Jan2_prop),mean(gh_bank$Feb2_prop),
    mean(gh_bank$Mar2_prop))
```

Here we create a character vector named months that contains the names of the months we need for our graph.
```{r}
months=c('Sep1','Oct1','Nov1','Dec1','Jan1','Feb1','Mar1','Apr1','May1','Jun1','Jul1','Aug1',
    'Sep2','Oct2','Nov2','Dec2','Jan2','Feb2','Mar2')
```

Let's male a new dataframe that has the prop_means and months together.
```{r}
gh_bank_summary<-data.frame(prop_means,months)
View(gh_bank_summary)
```

Now we need to tell R to order the months, rather than let it do it alphabetically.
```{r}
gh_bank_summary$months<-ordered(gh_bank_summary$months,
                                levels=c('Sep1','Oct1','Nov1','Dec1','Jan1','Feb1','Mar1','Apr1','May1','Jun1','Jul1','Aug1','Sep2','Oct2','Nov2','Dec2','Jan2','Feb2','Mar2'))
```

##ggplot
```{r}
gh_bank_gg<-ggplot(data=gh_bank_summary,
                   aes(x=months,y=prop_means))+
  geom_line(group=1)+
  geom_point()+
  xlab("Months")+
  ylab("Proportion Germinated")+
  scale_y_continuous(limits=c(0,1),
                     breaks=c(0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0))+
  theme_bw(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"),
        legend.position=c(0.8, 0.4))
gh_bank_gg

ggsave(plot=gh_bank_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/gh_bank_gg.png",width=25,height=15,units="cm",dpi=800)
```

##Playing
```{r}
gh_bank_gg1<-ggplot(data=gh_bank_summary,
                   aes(x=months,y=prop_means))+
  geom_line(group=1)+
  geom_point()+
  geom_bar(stat="identity",
           aes(y=prop_means),fill="blue",alpha=0.5)+ # Add the bar graph layer
  xlab("Months")+
  ylab("Proportion Germinated")+
  scale_y_continuous(limits=c(0,1),
                     breaks=c(0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0))+
  theme_bw(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"),
        legend.position=c(0.8, 0.4))
gh_bank_gg1

ggsave(plot=gh_bank_gg1,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/gh_bank_gg1.png",width=25,height=15,units="cm",dpi=800)
```

#All Data
Not every pot received 200 seeds, so here we will use all the data, knowing that the proportion is slightly off.
##Make a Compact Dataframe
```{r}
prop_means2=c(mean(gh_bank_all$Sep1_prop),mean(gh_bank_all$Oct1_prop),mean(gh_bank_all$Nov1_prop), 
             mean(gh_bank_all$Dec1_prop),mean(gh_bank_all$Jan1_prop),mean(gh_bank_all$Feb1_prop),
             mean(gh_bank_all$Mar1_prop),mean(gh_bank_all$Apr1_prop),mean(gh_bank_all$May1_prop),
             mean(gh_bank_all$Jun1_prop),mean(gh_bank_all$Jul1_prop),mean(gh_bank_all$Aug1_prop),
             mean(gh_bank_all$Sep2_prop),mean(gh_bank_all$Oct2_prop),mean(gh_bank_all$Nov2_prop), 
             mean(gh_bank_all$Dec2_prop),mean(gh_bank_all$Jan2_prop),mean(gh_bank_all$Feb2_prop),
             mean(gh_bank_all$Mar2_prop))
```

Here we create a character vector named months that contains the names of the months we need for our graph.
```{r}
months2=c('Sep1','Oct1','Nov1','Dec1','Jan1','Feb1','Mar1','Apr1','May1','Jun1','Jul1','Aug1',
         'Sep2','Oct2','Nov2','Dec2','Jan2','Feb2','Mar2')
```

Let's put them together
```{r}
gh_bank_summary2<-data.frame(prop_means2, months2)
View(gh_bank_summary2)
```

Tell R the order of the months
```{r}
gh_bank_summary2$months2<-ordered(gh_bank_summary2$months2,
                                  levels=c('Sep1','Oct1','Nov1','Dec1','Jan1','Feb1','Mar1','Apr1','May1','Jun1','Jul1','Aug1','Sep2','Oct2','Nov2','Dec2','Jan2','Feb2','Mar2'))
```

## Figure
```{r}
gh_bank_gg2<-ggplot(data=gh_bank_summary2,
                   aes(x=months2,
                   y=prop_means2)) +
  geom_line(group=1)+
  geom_point()+
  xlab("Months")+
  ylab("Proportion Germinated")+
  scale_y_continuous(limits=c(0,1),
                     breaks=c(0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0))+
  theme_bw(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"),
        legend.position=c(0.8, 0.4))
gh_bank_gg2

ggsave(plot=gh_bank_gg2,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/gh_bank_gg2.png",width=25,height=15,units="cm",dpi=800)
```


