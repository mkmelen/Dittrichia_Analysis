---
title: "Response to Soil Type and Competition"
output: html_notebook
date: December 2022
authors: Miranda Melen, Laura Goetz
editor_options: 
  markdown: 
    wrap: 72
---

#Background
We used a two-way factorial design with construction soil
and natural soil and three competition treatments (*Dittrichia
graveolens* grown alone, with *Bromus hordeaceus*, or with *Festuca
perennis*). These grasses were selected because they are commonly found
in California annual grasslands and were identified in many of the 8
paired sites. We collected *B. hordeaceus* seeds from Blue Oak Ranch
Reserve and *F. perennis* seeds from the Terrace Lands of Younger Lagoon
Reserve on the UCSC Coastal Science Campus.

Every pot had either one *D. graveolens* with one *B. hordeaceus* or one
with *F. perennis*, or no grass competitor (grown alone). We prepared
Deepots (D16; 5cm diameter, 18cm height) at the UCSC Coastal Science
Campus Greenhouse and filled with rehydrated soil: 384 pots were filled
with natural soil, and 384 with construction soil (768 pots total).

We germinated *D. graveolens* seeds in an incubation chamber with a
daytime temperature of 23ºC from 9AM-1AM and a nighttime temperature of
19ºC from 1AM-9AM. Grasses were germinated in trays with potting mix and
placed under fluorescent light banks for 16-hour length days and 8-hour
length nights. Once radicles and cotyledons emerged, seedlings were
transplanted in sets of six (one for each treatment) and then randomized
into a blocked design.

After 4 months, we measured grass height from the soil surface to the
longest tip of each grass bundle and measured *D. graveolens* leaf
length from stem node to leaf tip of the longest newest true leaf to
obtain an accurate estimate of the rosette size. We then harvested
aboveground biomass at the crown and dried it in a 60ºC oven for 3 days
before weighing it.

#Data Analysis 
Statistical analyses were performed in R version 4.2.1 (R
Core Team 2022) using a two-way factorial ANOVA to test for the effects
of soil and of competition on *D. graveolens* biomass. We used a
post-hoc Tukey test to compare the three competitive treatments (grown
alone, with *B. hordeaceus*, and with *F. perennis*) for each soil type
separately. We also quantified the response of *D. graveolens* to the
biomass of each competitor using linear regression models.

We tested for a difference between roadside and adjacent vegetation
habitat types on each soil type independently, using mixed-model ANOVA,
with site as a random effect and habitat (roadside or adjacent
vegetation) as a fixed effect. Biomass of both *D. graveolens* and the
grass competitors was ln-transformed before analysis.

##Models Included

#Libraries

```{r}
#install.packages("ggplot2")
#install.packages("tidyverse")
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("RColorBrewer")
#install.packages("data.table")
#install.packages("emmeans")
#install.packages("lme4")
#install.packages("patchwork")
#install.packages("Sleuth2")
library(ggplot2)
library(tidyverse)
library(dplyr)
library(tidyr)
library(RColorBrewer)
library(data.table)
library(emmeans)
library(lme4)
library(patchwork)
library(Sleuth2)
```

#Load Data 
This dataframe has one row per pot (768 observations). Data
are Dittrichia_biomass and Grass_biomass, both measured in grams, and
DittrichiaLLL_mm_3 which is the longest leaf length in mm. NAs in
columns are "no data" because there was no grass present in that pot at
the time of measurement.

```{r}
mydata<-read.csv("/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/data/greenhouse_competition/greenhouse_competition.csv",stringsAsFactors=T)
# change "NA" to "0"
mydata1<-mydata %>% 
  replace_na(list(Dittrichia_biomass=0,Grass_biomass=0,DittrichiaLLL_mm_3=0,GrassHeight_cm_3=0))
str(mydata) #Check that each column has the right class (factor, integer, numeric, etc.)
```

#Dittrichia Biomass

##Histograms

```{r}
#Dittrichia biomass
hist(mydata1$Dittrichia_biomass,col='steelblue',main='Original')
#Grass biomass
hist(mydata1$Grass_biomass,col='steelblue',main='Original')
#By soil type
ggplot(mydata1,aes(x=Dittrichia_biomass))+
  geom_histogram()+
  facet_wrap(vars(Soil))
ggplot(mydata1,aes(x=Grass_biomass))+
  geom_histogram()+
  facet_wrap(vars(Soil))
```

Data is skewed, so let's try log transforming. However, the values are
all \<0 which create negative numbers when log transforming, therefore
we need to multiply to move the decimal and then check the data again.

```{r}
#Prepare data for log transform (doing ln and log10)
log_mydata<-mydata1%>% 
  mutate(Dittrichia_biomass1000=Dittrichia_biomass*1000,Grass_biomass1000=Grass_biomass*1000)%>% 
  filter(Dittrichia_biomass!=0)%>% 
  mutate(log_Dittrichia=log10(Dittrichia_biomass1000))%>%
  mutate(log_Grass=log10(Grass_biomass1000))%>% 
  mutate(log_DittrichiaO=log10(Dittrichia_biomass))%>%
  mutate(log_GrassO=log10(Grass_biomass))

hist(log_mydata$log_Dittrichia,col='steelblue',main='Original')
shapiro.test(log_mydata$log_Dittrichia) #does not improve with log transform
hist(log_mydata$log_Grass,col='steelblue',main='Original')
shapiro.test(log_mydata$log_Grass) #does not compute?
```

##Model

###Best Model

###Risk Assessment

##ggplot ###Biomass x Competition and Soil

####Interaction Plot Note: 10 blocks, 5 treatments, 16 populations
(CHE-O), 8 sites (random: population pairs; CHE), 2 habitat (fixed
effect: roadside and off-road; R or O)

All data combined.

#####Biomass vs. Competition: Construction soil

```{r}
pd<-position_dodge(0)

comp_int_bio_con<-log_mydata%>% 
  filter(Soil=="Construction Soil") %>% 
  group_by(Competition,Habitat)%>%
  summarise(Mean=mean(log_Dittrichia),
            SD=sd(log_Dittrichia),
            N=length(log_Dittrichia))%>%
  mutate(SE=SD/sqrt(N))

comp_int_bio_con_gg<-ggplot(data=comp_int_bio_con,
                        aes(x=factor(Competition,levels=c("None","Festuca","Bromus")),
                            y=Mean,
                            shape=Habitat,
                            group=Habitat,
                            color=Habitat))+
  ylab("log(Biomass)")+
  #coord_cartesian(ylim=c(1,8))+
  xlab("")+
  ggtitle("Construction Soil")+
  theme_classic(base_size=16)+
  scale_y_continuous(name="Proportion Germinated", #y-axis: title
                     limits=c(0,8), #x-axis: range
                     breaks=seq(0,8,1))+ #x-axis: incremental breaks by giving range and requesting a sequence by 1
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  geom_line(size=1,
            position=pd)+
  geom_point(size=3,
             position=pd)+
  scale_color_manual(values=c("gray85","forestgreen"))+
  geom_errorbar(width=0.15,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE)))
comp_int_bio_con_gg

#ggsave(plot=comp_int_bio_con_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_int_bio_con_gg.png",width=25,height=20,units="cm",dpi=800)
```

#####Biomass vs. Competition: Field soil

```{r}
pd<-position_dodge(0)

comp_int_bio_field<-log_mydata%>% 
  filter(Soil=="Field Soil") %>% 
  group_by(Competition,Habitat)%>%
  summarise(Mean=mean(log_Dittrichia),
            SD=sd(log_Dittrichia),
            N=length(log_Dittrichia))%>%
  mutate(SE=SD/sqrt(N))

comp_int_bio_field_gg<-ggplot(data=comp_int_bio_field,
                        aes(x=factor(Competition,levels=c("None","Festuca","Bromus")),
                            y=Mean,
                            shape=Habitat,
                            group=Habitat,
                            color=Habitat))+
  ylab("log(Biomass)")+
   scale_y_continuous(name="Proportion Germinated", #y-axis: title
                     limits=c(0,8), #x-axis: range
                     breaks=seq(0,8,1))+ #x-axis: incremental breaks by giving range and requesting a sequence by 1
  #coord_cartesian(ylim = c(1,8))+
  xlab("")+
  ggtitle("Field Soil")+
  theme_bw(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  geom_line(size=1,
            position=pd)+
  geom_point(size=3,
             position=pd)+
  scale_color_manual(values=c("gray85","forestgreen"))+
  geom_errorbar(width=0.15,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE)))
comp_int_bio_field_gg

#ggsave(plot=comp_int_bio_field_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_int_bio_field_gg.png",width=25,height=20,units="cm",dpi=800)
```

#####Biomass vs. Competition: Both Soils Let's try putting both soil
Soil types together here and using the log10 data and µg as my units.

```{r}
pd<-position_dodge(0)

comp_int_bio_all<-log_mydata%>% 
  group_by(Soil,Competition,Habitat)%>%
  summarise(Mean=mean(log_Dittrichia),
            SD=sd(log_Dittrichia),
            N=length(log_Dittrichia))%>%
  mutate(SE=SD/sqrt(N))

comp_int_bio_all_gg<-ggplot(data=comp_int_bio_all,
                        aes(x=factor(Competition,levels=c("None","Bromus","Festuca")),
                            y=Mean))+
  scale_y_continuous(expression(atop(italic("Dittrichia graveolens")~biomass, (log[10](mg)))),
                     limits=c(-1,3), #y-axis: range
                     breaks=seq(-1,3,1))+ #y-axis: incremental breaks by giving range and requesting a sequence by 1
  xlab("")+
  ggtitle("")+
  theme_classic(base_size=16)+
  # theme(panel.border=element_blank(),
  #       panel.grid.major=element_blank(),
  #       panel.grid.minor=element_blank(),
  #       axis.line=element_line(colour="black"))+ 
  geom_line(size=1,
            position=pd,
            aes(linetype=Soil,
                group=interaction(Soil,Habitat),
                color=Habitat))+
  geom_point(size=5,
             position=pd,
             aes(shape=Habitat,
                 color=Habitat))+
  scale_color_manual(values=c("gray85","forestgreen"))+
  geom_errorbar(width=0.15,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE),
                    color=Habitat))+
  labs(color="Source Habitat",
       shape="Source Habitat",
       linetype="Soil Type")
comp_int_bio_all_gg

#ggsave(plot=comp_int_bio_all_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_int_bio_all_gg.png",width=25,height=15,units="cm",dpi=800)
```

#####Biomass vs. Competition: Both Soils but no habitat
Soil types together here and using the log10 data and µg as my units.

```{r}
pd<-position_dodge(0)

comp_int_bio_all<-log_mydata%>% 
  group_by(Soil,Competition)%>%
  summarise(Mean=mean(log_Dittrichia),
            SD=sd(log_Dittrichia),
            N=length(log_Dittrichia))%>%
  mutate(SE=SD/sqrt(N))

comp_int_bio_all_gg<-ggplot(data=comp_int_bio_all,
                        aes(x=factor(Competition,levels=c("None","Bromus","Festuca")),
                            y=Mean))+
  scale_y_continuous(expression(atop(italic("Dittrichia graveolens")~biomass, (log[10](mg)))),
                     limits=c(-1,3), #y-axis: range
                     breaks=seq(-1,3,1))+ #y-axis: incremental breaks by giving range and requesting a sequence by 1
  xlab("")+
  ggtitle("")+
  theme_classic(base_size=24)+
  # theme(panel.border=element_blank(),
  #       panel.grid.major=element_blank(),
  #       panel.grid.minor=element_blank(),
  #       axis.line=element_line(colour="black"))+ 
  geom_line(size=1,
            position=pd,
            aes(linetype=Soil,
                group=interaction(Soil),
                color=Soil))+
  geom_point(size=8,
             position=pd,
             aes(shape=Soil,
                 color=Soil))+
  scale_color_manual(values=c("gray85","forestgreen","black"))+
  geom_errorbar(width=0.2,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE),
                    color="Soil"))+
  labs(color="Soil Type",
       shape="Soil Type",
       linetype="Soil Type")
comp_int_bio_all_gg

ggsave(plot=comp_int_bio_all_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_int_bio_all_gg.png",width=25,height=15,units="cm",dpi=800)
```

Soil types together here too and using the log10 data on g
```{r}
pd<-position_dodge(0)

comp_int_bio_all<-log_mydata%>% 
  group_by(Soil,Competition,Habitat)%>%
  summarise(Mean=mean(log_DittrichiaO),
            SD=sd(log_DittrichiaO),
            N=length(log_DittrichiaO))%>%
  mutate(SE=SD/sqrt(N))

comp_int_bio_all_gg<-ggplot(data=comp_int_bio_all,
                        aes(x=factor(Competition,levels=c("None","Festuca","Bromus")),
                            y=Mean))+
  scale_y_continuous(expression(atop(italic("Dittrichia graveolens")~biomass, (log[10](g)))),
                     limits=c(-4,0), #y-axis: range
                     breaks=seq(-4,0,1))+ #y-axis: incremental breaks by giving range and requesting a sequence by 1
  xlab("")+
  ggtitle("")+
  theme_classic(base_size=16)+
  # theme(panel.border=element_blank(),
  #       panel.grid.major=element_blank(),
  #       panel.grid.minor=element_blank(),
  #       axis.line=element_line(colour="black"))+ 
  geom_line(size=1,
            position=pd,
            aes(linetype=Soil,
                group=interaction(Soil,Habitat),
                color=Habitat))+
  geom_point(size=5,
             position=pd,
             aes(shape=Habitat,
                 color=Habitat))+
  scale_color_manual(values=c("gray85","forestgreen"))+
  geom_errorbar(width=0.15,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE),
                    color=Habitat))+
  labs(color="Source Habitat",
       shape="Source Habitat",
       linetype="Soil Type")
comp_int_bio_all_gg

#ggsave(plot=comp_int_bio_all_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_int_bio_all_gg.png",width=25,height=15,units="cm",dpi=800)
```

#####Boxplot Not using

```{r eval=FALSE, include=FALSE}
competition1_gg<-ggplot(log_mydata)+
  geom_boxplot(aes(x=Competition, 
                   y=log_Dittrichia, 
                   fill=Soil))+
  theme_classic()+
  scale_fill_manual(values=c("gray58","forestgreen"))+
  labs(y="log(Biomass)",
       fill="Soil",
       x="Competition")
competition1_gg
#ggsave(plot=competition1_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/competition1_gg.png", width=20,height=25,units ="cm",dpi=800)
```

###Biomass x Competition and Soil and Population

#### Interaction Plots

Not used Plot by site.

```{r}
mydata_site_sum<-log_mydata%>%
  group_by(Habitat,Soil,Site)%>%
  summarise(Mean=mean(log_Dittrichia),
            SD=sd(log_Dittrichia),
            N=length(log_Dittrichia))%>%
  mutate(SE=SD/sqrt(N))%>%
  mutate(Cat=paste(Site,Habitat,sep="_"))

pd<-position_dodge(.8)
comp_int_site_gg<-ggplot(data=mydata_site_sum,
                         aes(x=factor(Soil),
                             y=Mean,
                             color=Site,
                             shape=Habitat,
                             group=Cat))+
  ylab("log(Biomass)")+
  xlab("Soil")+
  theme_bw()+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  geom_line(size=.8,position=pd)+
  geom_point(size=3,position=pd)+
  geom_errorbar(width=0.2,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE)))
comp_int_site_gg
```

Facet to make panels of the by site plot.

```{r}
mydata_site_sum<-log_mydata%>%
  group_by(Habitat,Soil,Site)%>%
  summarise(Mean=mean(log_Dittrichia),
            SD=sd(log_Dittrichia),
            N=length(log_Dittrichia))%>%
  mutate(SE=SD/sqrt(N))%>%
  mutate(Cat=paste(Site,Habitat,sep="_"))

pd<-position_dodge(.2)
comp_int_site_panel_gg<-ggplot(data=mydata_site_sum,
                               aes(x=factor(Soil),
                                   y=Mean,
                                   color=Site,
                                   shape=Habitat,
                                   group=Cat))+
  facet_wrap(~Site)+
  ylab("log(Biomass)")+
  xlab("Soil")+
  theme_bw()+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  geom_line(size=.8,position=pd)+
  geom_point(size=3,position=pd)+
  geom_errorbar(width=0.2,position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE)))
comp_int_site_panel_gg
```

####Boxplots Not using

```{r}
competition2_gg<-ggplot(log_mydata)+
  geom_boxplot(aes(x=Soil,
                   y=log_Dittrichia,
                   fill=Population))+
  theme_classic()+
  facet_grid(Habitat~.)+
  labs(y="log(Biomass)",
       fill="Population",
       x="Soil")
competition2_gg
```

## Biomass Scatterplot
Using original data with negatives
```{r}
#Prep data for scatterplot
comp_scatter<-log_mydata%>% 
  filter(Competition!="None")%>%
  filter(Grass_biomass!=0)%>% 
  mutate(scx=log(Grass_biomass),
         scy=log(Dittrichia_biomass))%>% 
  mutate(type=paste(Soil,Competition,sep="/"))

#Make the scatterplot
comp_scatter_gg<-ggplot(comp_scatter)+
  geom_point(aes(
    x=scx,
    y=scy,
    shape=type,
    color=Habitat))+
  scale_y_continuous(expression(atop(italic("Dittrichia graveolens")~biomass, (log[10](g)))),
                     limits=c(-9,-2), #y-axis: range
                     breaks=seq(-9,-2,1))+ #y-axis: incremental breaks by giving range and requesting a sequence by 1
  scale_x_continuous(expression("Grass"~biomass ~""~(log[10](g))),
                     limits=c(-7,2), #x-axis: range
                     breaks=seq(-7,2,1))+ #x-axis: incremental breaks by giving range and requesting a sequence by 1
  guides(fill=none)+
  scale_color_manual(values=c("gray85","forestgreen"))+
  scale_shape_manual(values=c(1,19,2,17))+
  geom_smooth(method=lm,
              aes(x=scx,
                  y=scy,
                  linetype=Soil),
              color="black")+
  theme_classic(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  labs(y="Dittrichia graveolens biomass (log(g10^4))",
       x="Grass biomass (log(g10^4))",
       shape="Soil Type/Competition Species",
       color="Source Habitat",
       linetype="")
comp_scatter_gg

#ggsave(plot=comp_scatter_gg,file ="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_scatter_gg.png",width=25,height=15,units="cm",dpi=800)
```


```{r}
#Prep data for scatterplot
comp_scatter<-log_mydata%>% 
  filter(Competition!="None")%>%
  filter(Grass_biomass!=0)%>% 
  mutate(scx=log(Grass_biomass1000),
         scy=log(Dittrichia_biomass1000))%>% 
  mutate(type=paste(Soil,Competition,sep="/"))

#Make the scatterplot
comp_scatter_gg<-ggplot(comp_scatter)+
  geom_point(aes(
    x=scx,
    y=scy,
    shape=type,
    color=Habitat))+
  scale_y_continuous(expression(atop(italic("Dittrichia graveolens")~biomass, (log[10](mg)))),
                     limits=c(-2,5), #y-axis: range
                     breaks=seq(-2,5,1))+ #y-axis: incremental breaks by giving range and requesting a sequence by 1
  scale_x_continuous(expression("Grass"~biomass ~""~(log[10](mg))),
                     limits=c(0,9), #x-axis: range
                     breaks=seq(0,9,1))+ #x-axis: incremental breaks by giving range and requesting a sequence by 1
  guides(fill=none)+
  scale_color_manual(values=c("gray85","forestgreen"))+
  scale_shape_manual(values=c(1,19,2,17))+
  geom_smooth(method=lm,
              aes(x=scx,
                  y=scy,
                  linetype=Soil),
              color="black")+
  theme_classic(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  labs(y="Dittrichia graveolens biomass (log(g10^4))",
       x="Grass biomass (log(g10^4))",
       shape="Soil Type/Competition Species",
       color="Source Habitat",
       linetype="")
comp_scatter_gg

#ggsave(plot=comp_scatter_gg,file ="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_scatter_gg.png",width=25,height=15,units="cm",dpi=800)
```

#Dittrichia Growth

Here we need to filter the data to only look at plant growth \> 0

```{r}
mydata_Dgrowth<-mydata%>%filter(DittrichiaLLL_mm_3>0) #Here I am only looking at the Dittrichia growth data that is greater than 0
#mydata_Ggrowth<-mydata%>%filter(GrassHeight_cm_3>0) #Here I am only looking at the Dittrichia growth data that is greater than 0
```

##Histograms

```{r}
#Dittrichia longest leaf length
hist(mydata_Dgrowth$DittrichiaLLL_mm_3,col='steelblue',main='Original')
```

Data is skewed, so let's try log transforming.

```{r}
#Prepare data for log transform
log_mydata_Dgrowth<-mydata_Dgrowth%>% 
  filter(Dittrichia_biomass!=0)%>%
 mutate(log_Dgrowth=log(DittrichiaLLL_mm_3))

hist(log_mydata_Dgrowth$log_Dgrowth,col='steelblue',main='Original')
shapiro.test(log_mydata_Dgrowth$log_Dgrowth) #does not improve with log transform
```

##Model ###Best Model ###Risk Assessment ##ggplot ###Growth Rate x
Competition and Soil

####Interaction Plot Note: 10 blocks, 5 treatments, 16 populations
(CHE-O), 8 sites (random: population pairs; CHE), 2 habitat (fixed
effect: roadside and off-road; R or O)

All data combined.

#####Growth Rate vs. Competition: Construction soil

```{r}
pd<-position_dodge(0)

comp_int_grow_con<-log_mydata_Dgrowth%>% 
  filter(Soil=="Construction Soil")%>% 
  group_by(Competition,Habitat)%>%
  summarise(Mean=mean(log_Dgrowth),
            SD=sd(log_Dgrowth),
            N=length(log_Dgrowth))%>%
  mutate(SE=SD/sqrt(N))

comp_int_grow_con_gg<-ggplot(data=comp_int_grow_con,
                        aes(x=factor(Competition,levels=c("None","Festuca","Bromus")),
                            y=Mean,
                            shape=Habitat,
                            group=Habitat,
                            color=Habitat))+
  ylab("log(Growth) mm")+
  coord_cartesian(ylim = c(1,4.5))+
  xlab("")+
  ggtitle("Construction Soil")+
  theme_bw(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  geom_line(size=1,
            position=pd)+
  geom_point(size=3,
             position=pd)+
  scale_color_manual(values=c("gray85","forestgreen"))+
  geom_errorbar(width=0.15,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE)))
comp_int_grow_con_gg

#ggsave(plot=comp_int_grow_con_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_int_grow_con_gg.png",width=25,height=20,units="cm",dpi=800)
```

#####Growth Rate vs. Competition: Field soil

```{r}
pd<-position_dodge(0.1)

comp_int_grow_field<-log_mydata_Dgrowth%>% 
  filter(Soil=="Field Soil") %>% 
  group_by(Competition,Habitat)%>%
  summarise(Mean=mean(log_Dgrowth),
            SD=sd(log_Dgrowth),
            N=length(log_Dgrowth))%>%
  mutate(SE=SD/sqrt(N))

comp_int_grow_field_gg<-ggplot(data=comp_int_grow_field,
                        aes(x=factor(Competition,levels=c("None","Festuca","Bromus")),
                            y=Mean,
                            shape=Habitat,
                            group=Habitat,
                            color=Habitat))+
  ylab("log(Growth) mm")+
  coord_cartesian(ylim=c(1,4.5))+
  xlab("")+
  ggtitle("Field Soil")+
  theme_bw(base_size=16)+
  theme(panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        axis.line=element_line(colour="black"))+
  geom_line(size=1,
            position=pd)+
  geom_point(size=3,
             position=pd)+
  scale_color_manual(values=c("gray85","forestgreen"))+
  geom_errorbar(width=0.15,
                position=pd,
                aes(ymin=(Mean-SE),
                    ymax=(Mean+SE)))
comp_int_grow_field_gg

#ggsave(plot=comp_int_grow_field_gg,file="/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/figures/comp_int_grow_field_gg.png",width=25,height=20,units="cm",dpi=800)
```
#Load field soil data only
```{r}
mydata_field<-read.csv("/Users/Miranda/Documents/Education/UC Santa Cruz/Dittrichia/Dittrichia_Analysis/data/greenhouse_competition/greenhouse_competition_fieldsoil.csv",stringsAsFactors=T)
# change "NA" to "0"
mydata_field1<-mydata_field %>% 
  replace_na(list(Dittrichia_biomass=0,Grass_biomass=0,DittrichiaLLL_mm_3=0,GrassHeight_cm_3=0))
mydata_field1$LRR_All<-as.numeric(mydata_field1$LRR_All)
str(mydata_field1) #Check that each column has the right class (factor, integer, numeric, etc.)
```

##Summarize data
```{r}

```

